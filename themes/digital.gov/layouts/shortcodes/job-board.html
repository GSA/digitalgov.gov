{{/* <!-- prettier-ignore -->
  Communities of Practice Job Board Shortcode
  Formats job posting information from "job-board.yml" into a table, as seen on Communities of Practice Job Board "job-board.md"
  Add new job posting on "job-board.yml" to display in job posting table.
  No params needed
*/}}

{{/* Dictionary used to convert CoP names to its acronym for style formatting */}}
{{ $acronymToCop := dict
  "Communicators" "FCN"
  "Multilingual" "ML"
  "Plain Language" "PL"
  "Social Media" "SM"
  "User Experience" "UX"
  "Web Analytics" "WAO"
  "Web Managers" "WCM"
  "Contact Center" "CC"
}}

{{ $now := now.Format "2006-01-02" }}
{{ $anyActivePost := false }}

<!-- This formats job postings into the DG blog style -->
{{ range .Site.Data.job_board }}
  {{ if ge .close_date $now }}
    {{ $anyActivePost = true }}
    <article class="card card-job" aria-labelledby="{{ .title }}">
      <div class="card__content">
        <h3 id="{{ .title }}">{{- .title | markdownify -}}</h3>
        <a
          class="card__apply usa-button"
          href="{{ .apply_link | safeURL }}"
          target="__blank"
        >
          Apply
        </a>
        <div class="card__summary">
          <div class="card__department">{{ .department | markdownify }}</div>
          <div class="card__location">{{ .location | markdownify }}</div>
          <p>{{ .description | markdownify }}</p>
        </div>
      </div>

      <div class="card__meta">
        <div class="date">Open {{ .open_date | time.Format ":date_long" }} to {{ .close_date | time.Format ":date_long" }}</div>
        {{ range .cop_topics }}
          {{ $topic := . }}
          {{ $acronym := index $acronymToCop $topic }}
          <div class="cop-topic--{{ $acronym }}">
            {{- $topic -}}
          </div>
        {{ end }}
      </div>
    </article>
  {{ end }}
{{ end }}


{{ if not $anyActivePost }}
    <div id="no_job_postings">There are no active job postings at the moment. Please check back another time.</div>
{{ end }}


