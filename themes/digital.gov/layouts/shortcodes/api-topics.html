{{- partial "core/set-env.html" . -}}
{{- $list := (where .Site.Pages "Section" "topics") -}}
{{- $length := len $list -}}
{ "version" : "https://jsonfeed.org/version/1", "content" : "topics", "type" :
"list", "title" : "Topics | {{- .Site.Title -}}", "home_page_url" :
"{{- .Site.BaseURL -}}", "count" : "{{- $length -}}", "items" : [
{{- range $topic := $list.ByTitle -}}
  {{- with $topic -}}
    {
    {{ $path := "" }}{{ with .File }}
      {{ $path = .Path }}
    {{ else }}
      {{ $path = .Path }}
    {{ end }}
    "title" : "{{- .Title -}}", "summary" :
    "{{- replace .Params.summary "\n" "\\n" -}}",
    {{- partial "api/aliases.html" . -}}
    {{- if .Params.weight -}}
      "weight" : "{{- .Params.weight -}}",
    {{- end -}}
    {{- partial "api/file-info.html" . }}
    {{- partial "api/slug.html" . }}
    }
    {{- $.Scratch.Add "i" 1 -}}
    {{- $iterator := $.Scratch.Get "i" -}}
    {{- if not (eq $length $iterator) -}},{{- end -}}

  {{- end -}}
{{- end -}}
] }
