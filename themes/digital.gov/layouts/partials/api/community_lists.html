{{- if (isset .Params "community_list") -}}
  "community_list" : [
  {{- $community_lists := .Params.community_list -}}
  {{- $length := $community_lists | len -}}
  {{- $.Scratch.Set "count" 1 -}}
  {{/* Loop through each of the $community_lists */}}
  {{- range $index, $list := $community_lists -}}
    {{/* Check if there is a community_list or multiple */}}
    {{- with $list -}}
      {{/* Get the count */}}
      {{- $count := $.Scratch.Get "count" -}}
      {
      {{/* Get the number of elements in this community_list */}}
      {{- $sub_length := $list | len -}}

      {{/* Set the count for this community_list to 1 */}}
      {{- $.Scratch.Set "sub_count" 1 -}}
      "members" : "{{- $list.members -}}", "subscribe_email_subject" :
      "{{- $list.subscribe_email_subject -}}"
      {{/* Loop through the elements in this community_list */}}

      {{- if eq $count $length -}}
        }
      {{- else -}}
        ,
      {{- end -}}{{- $.Scratch.Add "count" 1 -}}
    {{- end -}}
  {{- end -}}
  ],
{{- end -}}
