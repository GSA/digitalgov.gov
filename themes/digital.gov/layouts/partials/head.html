<!DOCTYPE html>
<html lang="en-US" itemscope itemtype="http://schema.org/WebSite" prefix="og: http://ogp.me/ns#">

<head profile="http://gmpg.org/xfn/11">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  {{ "<!-- Page Title -->" | safeHTML }}
  <title>{{ $.Scratch.Get "headtitle" | default (printf "%s / %s" .Title .Site.Title | markdownify) }}</title>

  {{ "<!-- Meta Description -->" | safeHTML }}
  <meta name="description" content="{{ $.Params.summary | default $.Site.Params.description | markdownify }}" />
  {{ $sitetags := $.Site.Data.tag }}
  {{ with $.Params.tag }}
    {{ $_taxonomy := .}}
    {{ $length := $_taxonomy | len }}

  {{ "<!-- Meta Keywords -->" | safeHTML }}
  <meta name="keywords" content='{{ range $i, $e := $_taxonomy }}{{ $slug := $e | urlize }}{{ $tag := index $sitetags $slug }}{{ if lt (add $i 1) $length }}{{ $tag.display_name }},{{ else }}{{ $tag.display_name }}{{ end }}{{ end }}'>
  {{ end }}

  <!-- Logic for featured image -->
  {{/* Featured_image call */}}
    {{ $cdnurl := .Site.Params.cdnurl }}
    {{ $featImg := index $.Site.Data.images (default "digital-gov-card" .Params.featured_image.uid) }}
    {{ $featImgBase := $featImg.uid }}
    {{ $featImgExt := $featImg.format }}
    {{ $featImgBaseCDN := printf "%s/%s" $cdnurl $featImgBase }}
    {{ $featImgWidth := $featImg.width }}
    {{ $featImgHeight := $featImg.height }}
    {{ $.Scratch.Set "featImgSuffix" "" }}
    {{ if gt $featImgWidth 1200 }}
     {{ $.Scratch.Set "featImgSuffix" "_w1200" }}
    {{ end }}
    {{ if gt $featImgWidth 800 }}
     {{ $.Scratch.Set "featImgTwitterSuffix" "_w800" }}
    {{ end }}
    {{ $featImgURL := printf "%s%s.%s" $featImgBaseCDN ($.Scratch.Get "featImgSuffix") $featImgExt }}
    {{ $featImgTwitterURL := printf "%s%s.%s" $featImgBaseCDN ($.Scratch.Get "featImgTwitterSuffix") $featImgExt }}
  {{/* End featured_image call */}}

  <!-- Logic for Page Types -->
  {{/* Get Page Type */}}
  {{ if .IsPage }}
    {{ $.Scratch.Set "pagetype" "article" }}
  {{ else }}
    {{ $.Scratch.Set "pagetype" "website" }}
  {{ end }}

  {{ "<!-- Start of Facebook Open Graph -->" | safeHTML }}
  <meta property="og:title" content="{{ $.Params.title | default $.Site.Title | markdownify }}" />
  <meta property="og:description" content="{{ $.Params.summary | default $.Site.Params.description | markdownify }}">
  <meta property="og:type" content="{{ $.Scratch.Get "pagetype" }}">
  <meta property="og:url" content="{{ .Permalink }}" />
  <meta property="og:image" content="{{ $featImgURL }}" />
  <meta property="og:image" content="https://s3.amazonaws.com/digitalgov/tile-1.png" />
  <meta property="og:image" content="https://s3.amazonaws.com/digitalgov/tile-2.png" />
  <meta property="og:image:width" content="{{ $featImgWidth }}" />
  <meta property="og:site_name" content="DigitalGov">
  <meta property="fb:admins" content="100000569454928" />
  <meta property="article:publisher" content="https://www.facebook.com/digitalgov" />
  <meta property="article:author" content="willsullivan" />
  <meta property="article:published_time" content="2017-09-25T09:00:15Z" />
  <meta property="article:modified_time" content="2017-09-25T09:00:15Z" />
  {{ "<!-- End of Facebook Open Graph -->" | safeHTML }}

  {{ "<!-- Start of Twitter Card -->" | safeHTML }}
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@Digital_Gov" />
  <meta name="twitter:creator" content="@Digital_Gov" />
  <meta property="twitter:description" content="{{ $.Params.summary | default $.Site.Params.description | markdownify }}">
  <meta property="twitter:title" content="{{ $.Params.title | default $.Site.Title | markdownify }}">
  <meta property="twitter:image" content="{{ $featImgTwitterURL }}">
  <meta itemprop="image" content="{{ $featImgURL }}" />
  {{ "<!-- End of Twitter -->" | safeHTML }}

  {{/* Only if this is a crosspost â€” need to add to frontmatter */}}
  {{ with $.Params.xposted_from }}
  {{ "<!-- Cross posted -->" | safeHTML }}
  <link rel="canonical" href="{{ . }}" />
  {{ end }}

  {{/* TODO: what does this do? */}}
  {{ "<!-- Schema.org -->" | safeHTML }}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "DigitalGov - U.S. General Services Administration,  Office of Citizen Services and Innovative Technologies",
      "url": "https://www.digitalgov.gov",
      "sameAs": ["https://www.facebook.com/digitalgov", "https://twitter.com/digital_gov", "https://plus.google.com/+DigitalgovGov1/", "https://www.youtube.com/user/howtogov", "https://www.linkedin.com/groups/5016512"]
    }
  </script>

  {{/* RSS feed of recent posts */}}
  {{ "<!-- RSS Feed-->" | safeHTML }}
  <link rel="alternate" type="application/rss+xml" title="DigitalGov &raquo; Feed" href="https://www.digitalgov.gov/feed/" />

  {{/* TODO: should we keep this? */}}
  {{/* Can Hugo build an iCal feed of Cal feed */}}
  <!-- <link rel="alternate" type="text/calendar" title="DigitalGov &raquo; iCal Feed" href="https://www.digitalgov.gov/events/?ical=1" /> -->

  {{/* TODO: All these styles need to be audited / minified / etc */}}
  {{ "<!-- CSS -->" | safeHTML }}
  <link rel='stylesheet' href='{{ "css/widget.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/dashicons.min.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/sitesusagov.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/mtphr-tabs.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/mtphr-tabs.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/mtphr-styles.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/mtphr-style.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/enlightened-styles.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/style-font.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/style-responsive.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/wpp.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/shortcodes.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/custom.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/style-front-end.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/notice-bar.css" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/tribe-events-full.min.css?ver=4.4.1.1" | absURL }}' type='text/css' media='all' />
  <link rel='stylesheet' href='{{ "css/tribe-events-theme.min.css?ver=4.4.1.1" | absURL }}' type='text/css' media='all' />
  <link rel="stylesheet" media="all" href="{{ "css/override.css" | absURL }}" type="text/css" />
  <link rel='stylesheet' href='{{ "css/federalist-additions.css" | absURL }}' type='text/css' media='all' />

  {{/* Add add to calendar sheet in events */}}
  {{ if eq .Section "events" }}
  {{ "<!-- Add to Calendar CSS -->" | safeHTML }}
  <link href="https://addtocalendar.com/atc/1.5/atc-style-blue.css" rel="stylesheet" type="text/css">
  {{ end }}

  {{/* TODO: Do we need all these jquery? */}}
  {{ "<!-- jQuery | ver=1.12.4 -->" | safeHTML }}
  <script type='text/javascript' src='{{ "js/jquery.js" | absURL }}'></script>
  <script type='text/javascript' src='{{ "js/jquery-migrate.min.js" | absURL }}'></script>

  {{/* TODO: Audit javascript */}}
  {{ "<!-- JS -->" | safeHTML }}
  <script type='text/javascript' src='{{ "js/sitesusagov.js" | absURL }}'></script>
  <script type='text/javascript' src='{{ "js/froogaloop.min.js" | absURL }}'></script>
  <script type='text/javascript' src='{{ "js/flexslider-min.js" | absURL }}'></script>
  <script type='text/javascript' src='{{ "js/flex-script-main.js" | absURL }}'></script>

  {{ "<!-- Digital Analytics Program / DAP -->" | safeHTML }}
  <script language="javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?ver=true&agency=GSA"></script>

  {{/* TODO: Should we get this local? */}}
  {{ "<!-- Favicon -->" | safeHTML }}
  <link rel="shortcut icon" href="https://s3.amazonaws.com/digitalgov/favicon.ico" type="image/x-icon" />

  <meta name="viewport" content="width=device-width,initial-scale=1" />

  {{ partial "head--custom-css.html" . }}
</head>
