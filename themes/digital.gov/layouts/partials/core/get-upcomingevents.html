{{/* =====
  Display upcoming events associated with a community of practice
*/}}

{{ $upcoming_events := where (where .Site.RegularPages.ByDate.Reverse "Section" "events") ".Date.Unix" ">" now.Unix }}
{{ $upcoming_events = $upcoming_events | intersect (where $upcoming_events "Date" ">" now) }}
{{ $total_events := where $upcoming_events ".Params.event_cop" "eq" .Params.event_cop }}

{{ if $total_events }}
  <div class="upcoming-events">
    <h2>Upcoming Events</h2>
    <ul>
      {{ range $total_events }}
        <li>
          <a href="{{ .Permalink }}" title="{{ .Title | markdownify }}"
            >{{ .Title | markdownify }}
          </a>
          ({{ dateFormat "01/02/2006" .Params.date }})
        </li>
      {{ end }}
    </ul>
    <br />
  </div>
{{ end }}
