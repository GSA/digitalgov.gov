{{/* Featured Resource Component

  @params {string} resourcePath - A relative hugo path to lookup a page to feature, use a forward slash before the path and no trailing slash.
  @params {string} kicker - Text that is displayed above the resources main content.

  @example shortcode
  {{< featured-resource resourcePath = "/guides/hcd/discovery-concepts"
>}}


<!-- prettier-ignore -->
Resource paths allowed:
  - 18f-accessibility-guide
  - /18f-accessibility-guide
  - /resources/18f-accessibility-guide

@example Community shortcodes
{{< featured-resource resourcePath = "/communities/communicators" kicker = "Join the Community" >}}


<!-- prettier-ignore -->
Community resource paths:
  - communicators
  - multilingual
  - plain-language
  - social-media
  - user-experience
  - web-analytics-and-optimization
  - web-managers-forum
*/}}

{{ $resource := .data }}
{{ $internalLink := "" }}
{{ $externalLink := "" }}
{{ $title := "" }}
{{ $summary := "" }}
{{ $image := "" }}
{{ $kicker := "" }}
{{ $isExternal := false }}



{{/* Check if page is an external link, otherwise return a hugo page object */}}
{{ if strings.HasPrefix $resource.link "https://" }}
  {{ $isExternal = true }}
  {{ $title = $resource.title }}
  {{ $summary = $resource.summary }}
  {{ $kicker = $resource.kicker }}
  {{ $externalLink = $resource.link }}
{{ else }}
  {{ $page := .Site.GetPage $resource.link }}
  {{ $title = $page.Title }}
  {{ $internalLink = $page.Permalink }}
  {{ $summary = $page.Params.summary }}
  {{ $image = $page.Params.image }}

  {{/* Check if kicker is present as a custom key, otherwise use page parameter to set */}}
  {{ if $resource.kicker }}
    {{ $kicker = $resource.kicker }}
  {{ else }}
    {{ if $page.Params.kicker }}
      {{ $kicker = $page.Params.kicker }}
    {{ end }}
  {{ end }}
{{ end }}




{{- if $resource -}}
  <div class="dg-featured-resource">
    <a
      href="{{ if $isExternal }}
        {{ $externalLink }}
      {{ else }}
        {{- $internalLink | relURL -}}
      {{ end }}"
      class="dg-featured-resource__body"
    >
      <div class="dg-featured-resource__text">
        <p class="dg-featured-resource__text-kicker">
          {{- if $kicker -}}
            {{- $kicker | markdownify -}}
          {{- else -}}
            Featured Resource
          {{- end -}}
        </p>
        <h2 class="dg-featured-resource__text-title">
          {{ if $title }}
            {{- $title -}}
          {{ end }}
        </h2>
        <p class="dg-featured-resource__text-description">
          {{ if $summary }}
            {{- $summary -}}
          {{ end }}
        </p>
      </div>
      {{ if $image }}
        <div class="dg-featured-resource__image">
          {{- partial "core/img-flexible.html" (dict "Site" .Site "src" $image "small" "true") -}}
        </div>
      {{ end }}
    </a>
  </div>
{{- end -}}
