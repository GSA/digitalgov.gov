{{ define "content" }}
  {{/* Gets the past events */}}
  {{- $events := where .Site.RegularPages.ByDate.Reverse "Section" "events" -}}
  {{- $past_events := where (where .Site.RegularPages.ByDate.Reverse "Section" "events") ".Date.Unix" "<" now.Unix -}}
  {{- $all_events := union $past_events $events -}}

  {{/* Gets the recent blog posts */}}
  {{- $posts := where .Pages "Section" "news" -}}

  {{/* Merges the past events and the recent blog posts */}}
  {{ $stream := union $all_events $posts }}


  <main role="main" id="main-content" class="grid-container-desktop">
    <header class="page-head page-head-{{- .Type -}} grid-row">
      <div class="grid-col-12">
        <h1>{{- .Title | markdownify -}}</h1>

        {{- if .Params.deck -}}
          <h2 class="deck">{{- .Params.deck | markdownify -}}</h2>
        {{- end -}}


        <div class="join-buttons">
          <a href="{{- "/join" | absURL -}}">Write for us</a>
        </div>
      </div>
    </header>

    <section class="stream">
      {{/* If there are any items at all... */}}
      {{- if $stream -}}
        {{/* Loop through all the pages */}}
        {{/* Also sorting all the items by date and reverse chron */}}
        {{- range (.Paginate ( $stream.ByDate.Reverse )).Pages -}}

          {{- if eq .Type "events" -}}
            {{- .Render "card-event" -}}
          {{- end -}}

          {{- if eq .Type "news" -}}
            {{/* External links */}}
            {{- if .Params.source -}}
              {{/* see /layouts/news/ for card templates */}}
              {{ .Render "card-elsewhere" }}
            {{ else }}
              {{/* Blog Posts — Internal links */}}
              {{- if .Params.deck }}
                {{/* see /layouts/news/ for card templates */}}
                {{ .Render "card-article" }}
              {{ else }}
                {{/* see /layouts/news/ for card templates */}}
                {{ .Render "card-article" }}
              {{ end }}
            {{ end }}
          {{- end -}}

        {{ end }}
      {{ end }}
      {{ partial "core/pagination.html" . }}
    </section>
  </main>
{{ end }}
