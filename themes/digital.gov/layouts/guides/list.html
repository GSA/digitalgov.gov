{{/* Display guides in a card list that uses the guide_weight field to display each card */}}

{{ define "content" }}

  {{ $guidesList := slice }}
  {{ $guidesData := slice }}
  {{ $guidePages := slice }}

  {{/* Build list of guide names from yaml files in string format */}}
  {{ range $i, $names := $.Site.Data.guidenav }}
    {{ $guidesList = $guidesList | append $i }}
  {{ end }}

  {{/* Iterate over list of guide names and save each as a map of strings */}}
  {{ range $guidesList }}
    {{ $guidesData = $guidesData | append (index $.Site.Data.guidenav .) }}
  {{ end }}

  {{/* Save each guide homepage as hugo page collection */}}
  {{ range $guidesData }}
    {{/* Get the first nav item from each guide, the guide homepage */}}
    {{ range first 1 .nav }}
      {{ $guidePages = $guidePages | append ($.Site.GetPage .path) }}
    {{ end }}
  {{ end }}


  <main role="main" id="main-content">
    <div class="grid-container-desktop">
      <header class="page-head">
        {{/* Page Title */}}
        <h1>{{- .Title | markdownify -}}</h1>

        {{/* Deck */}}
        {{- if .Params.deck -}}
          <h2 class="deck">{{- .Params.deck | markdownify -}}</h2>
        {{- end -}}
      </header>

      <section class="dg-guides usa-section">
        {{ range $guidePages.ByParam "guide_weight" }}
          {{ if .Params.guide_weight }}
            {{ .Render "card-guide" }}
          {{ end }}
        {{ end }}
      </section>
    </div>
  </main>
{{ end }}
