{{ define "content" }}
  {{ $path := "" }}{{ with .File }}
    {{ $path = .Path }}
  {{ else }}
    {{ $path = .Path }}
  {{ end }}


  <section class="grid-container-desktop">
    {{- partial "partials/core/usa-breadcrumbs.html" . -}}


    <header>
      <div data-gh-edit-page="{{- $path -}}">
        <h1>{{ .Title | markdownify }} Community</h1>

        {{- if .Params.deck -}}
          <div class="deck">{{- .Params.deck | markdownify -}}</div>
        {{- end -}}
      </div>
    </header>

    <section class="usa-in-page-nav-container">
      <main id="main-content">
        {{/* Summary */}}
        {{- if .Params.summary -}}
          <div class="content usa-prose" data-gh-edit-page="{{- $path -}}">
            <p>{{- .Params.summary | markdownify -}}</p>

            {{- if .Params.community_list -}}
              <section class="join-community-form">
                <h4 class="join-community-form__header">
                  <svg
                    class="join-community-form__header-svg usa-icon dg-icon dg-icon--extra-large margin-bottom-05"
                    aria-hidden="true"
                    focusable="false"
                  >
                    <use
                      xlink:href="{{ "uswds/img/sprite.svg#groups" | relURL }}"
                    ></use>
                  </svg>
                  Connect with us
                </h4>

                {{- range $i, $e := .Params.community_list -}}
                  <div class="join-community-form__body">
                    <div class="join-community-form__body-eligibility">
                      {{/* Checks to see if the community is public or govt only and sets the "terms" of the community, with an option to override the terms for each community by setting it in the front matter */}}

                      {{/* PUBLIC */}}
                      {{- if eq $e.type "public" -}}
                        {{/* Checking to see if community terms are defined */}}
                        {{- if $e.terms -}}
                          <p>{{- $e.terms | markdownify -}}</p>
                        {{- else -}}
                          <p>Open to the public.</p>
                        {{- end -}}
                      {{- end -}}

                      {{/* GOVT */}}
                      {{- if eq $e.type "government" -}}
                        {{- if $e.terms -}}
                          <p>{{- $e.terms | markdownify -}}</p>
                        {{- else -}}
                          <p>
                            Open to anyone with a .gov or .mil email address.
                          </p>
                        {{- end -}}
                      {{- end -}}

                      {{/* GOVT_ONLY */}}
                      {{- if eq $e.type "government_only" -}}
                        {{- if $e.terms -}}
                          <p>{{- $e.terms | markdownify -}}</p>
                        {{- else -}}
                          <p>Open to any government employee.</p>
                        {{- end -}}
                      {{- end -}}
                    </div>

                    <div class="join-community-form__body-email">
                      {{/* Community JOIN types ---
                        - Listerv via an email (most common)
                        - Listerv via a form
                        - Google Group
                        - Slack
                      */}}
                      {{/* Listserv Platforms without form sign-up option */}}
                      {{- if and (eq $e.platform "listserv") (not $e.subscribe_form ) -}}
                        {{- partial "core/community-join-without-form.html" (dict "context" . "e" $e) -}}
                      {{- end -}}

                      {{/* Google Group platforms */}}
                      {{- if and (eq $e.platform "google-group") ( $e.subscribe_form ) -}}
                        {{- partial "core/community-join-google-group.html" (dict "context" . "e" $e) -}}
                      {{- end -}}

                      {{/* Slack platforms */}}
                      {{- if and (eq $e.platform "slack") ( $e.subscribe_form ) -}}
                        {{- partial "core/community-join-slack.html" (dict "context" . "e" $e) -}}
                      {{- end -}}

                    </div>
                  </div>
                {{- end -}}
              </section>
            {{- end -}}
            <div>
              {{- .Content -}}
            </div>

            <div class="community_events">
              {{- partial "core/get-upcomingevents.html" . -}}
            </div>

            <div class="Community_conduct">
              <h2 id="community-conduct">Community Conduct</h2>
              {{- partial "core/community_pagefooter.html" . -}}
              <br />
            </div>
            <div>
              <br />
              {{- partial "core/gh-commit-info.html" . -}}
            </div>
          </div>
        {{- end -}}
      </main>
      <aside
        class="usa-in-page-nav dg-sidebar"
        data-title-heading-level="h3"
        data-root-margin="-350px 0px -350px 0px"
      ></aside>
    </section>
  </section>
{{ end }}
